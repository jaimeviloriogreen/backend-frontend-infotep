(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))r(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function l(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerPolicy&&(o.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?o.credentials="include":t.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(t){if(t.ep)return;t.ep=!0;const o=l(t);fetch(t.href,o)}})();const i=document.querySelector(".alert"),_=document.querySelector(".alert__text"),L=document.querySelector(".alert__icon");L.addEventListener("click",E);function v(e,n,l,r,t,o,a){let s=!0;const c=/^([a-zA-ZÀ-ÿ]{2,})(\s[a-zA-ZÀ-ÿ]+)*$/g,f=/^([0-9]{11})$/g,m=/^([0-9]{10})$/g,p=/^([0-9]{1,3})$/g,h=/^([a-zA-ZÀ-ÿ.#,0-9]{2,})(\s[a-zA-ZÀ-ÿ.#,0-9]+)*$/g;if(c.lastIndex=0,!c.test(n))return e.nombre.focus(),u(s),s;if(c.lastIndex=0,!c.test(l))return e.apellido.focus(),u(s),s;if(!f.test(r))return e.cedula.focus(),u(s),s;if(!m.test(t))return e.telefono.focus(),u(s),s;if(!h.test(a))return e.direccion.focus(),u(s),s;if(!p.test(o))return e.edad.focus(),u(s),s;if(s=!1,!s)return e.reset(),u(s),{error:s,data:{nombre:n,apellido:l,cedula:r,telefono:t,edad:o,direccion:a}}}function u(e){e?(_.textContent="¡Tienes un error!",i.classList.contains("success")&&i.classList.remove("success"),i.classList.add("error")):(_.textContent="¡Registro exitoso!",i.classList.contains("error")&&i.classList.remove("error"),i.classList.add("success"))}function E(){i.classList.forEach(e=>e!="alert"?i.classList.remove(e):null)}const d=document.querySelector(".form"),y=document.querySelector(".table__tbody"),b=document.querySelector(".table__thead");x();d.addEventListener("submit",C);async function C(e){e.preventDefault();const n=d.nombre.value,l=d.apellido.value,r=d.cedula.value,t=d.telefono.value,o=d.edad.value,a=d.direccion.value,{error:s=!0,data:c=null}=v(d,n,l,r,t,o,a);console.log({error:s,data:c}),s||await N(c)&&x()}async function N({nombre:e,apellido:n,cedula:l,telefono:r,edad:t,direccion:o}){return await(await fetch("http://localhost:4500/add_persons",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify({nombre:e,apellido:n,cedula:l,telefono:r,edad:t,direccion:o})})).json()}async function q(){try{return await(await fetch("http://localhost:4500/get_persons",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"}})).json()}catch(e){return console.log(e.message),e.message}}async function x(){const{persons:e}=await q();y.innerHTML="",e.length>0?b.classList.remove("table__thead--hide"):b.classList.add("table__thead--hide"),e.forEach(({nombre:n,apellido:l,cedula:r,telefono:t,direccion:o,edad:a})=>{const s=document.createElement("tr");s.className="table__datarow";const c=document.createElement("td"),f=document.createElement("td"),m=document.createElement("td"),p=document.createElement("td"),h=document.createElement("td"),g=document.createElement("td");c.className="table__tdata",f.className="table__tdata",m.className="table__tdata",p.className="table__tdata",h.className="table__tdata",g.className="table__tdata",c.textContent=n,f.textContent=l,m.textContent=r,p.textContent=t,h.textContent=o,g.textContent=a,s.append(c,f,m,p,h,g),y.appendChild(s)})}
